class ChessboardPuzzle{constructor(){this.boardSize=8,this.currentBoard=1,this.orientation="horizontal",this.dominoes=[],this.boards={1:{blocked:[[1,1],[8,8]],maxDominoes:31},2:{blocked:[[1,1],[1,2]],maxDominoes:31},3:{blocked:[[4,4],[5,5]],maxDominoes:31},4:{blocked:[[1,1],[2,1]],maxDominoes:31}},this.initializeBoard(),this.setupEventListeners()}initializeBoard(){this.renderBoard(),this.updateTileCounter()}renderBoard(){const e=document.getElementById("gameBoard");e.innerHTML="";const t=this.boards[this.currentBoard].blocked;for(let o=0;o<this.boardSize;o++)for(let i=0;i<this.boardSize;i++){const s=document.createElement("div");s.className="square",s.dataset.row=o,s.dataset.col=i,(o+i)%2==0?s.classList.add("white"):s.classList.add("black");t.some((([e,t])=>e-1===o&&t-1===i))&&s.classList.add("blocked"),e.appendChild(s)}this.dominoes.forEach(((e,t)=>{this.renderDomino(e,t)}))}renderDomino(e,t){const o=document.getElementById("gameBoard"),i=document.createElement("div");i.className=`domino ${e.orientation}`,i.dataset.index=t;const s=o.querySelector(".square").offsetWidth,n=e.row,a=e.col;i.style.left=a*s+10+"px",i.style.top=n*s+10+"px",i.addEventListener("click",(e=>{e.stopPropagation(),this.removeDomino(t)})),o.appendChild(i);this.getDominoSquares(e).forEach((([e,t])=>{const o=document.querySelector(`[data-row="${e}"][data-col="${t}"]`);o&&o.classList.add("covered")}))}setupEventListeners(){document.getElementById("gameBoard").addEventListener("click",(e=>this.handleSquareClick(e))),document.getElementById("resetBtn").addEventListener("click",(()=>this.reset())),document.getElementById("orientationBtn").addEventListener("click",(()=>this.toggleOrientation())),document.querySelectorAll(".board-btn").forEach((e=>{e.addEventListener("click",(e=>this.switchBoard(parseInt(e.target.dataset.board))))}))}handleSquareClick(e){const t=e.target.closest(".square");if(!t||t.classList.contains("blocked")||t.classList.contains("covered"))return;const o=parseInt(t.dataset.row),i=parseInt(t.dataset.col);this.canPlaceDomino(o,i,this.orientation)&&this.placeDomino(o,i,this.orientation)}canPlaceDomino(e,t,o){return"horizontal"===o?!(t+1>=this.boardSize)&&(!this.isSquareOccupied(e,t)&&!this.isSquareOccupied(e,t+1)):!(e+1>=this.boardSize)&&(!this.isSquareOccupied(e,t)&&!this.isSquareOccupied(e+1,t))}isSquareOccupied(e,t){const o=document.querySelector(`[data-row="${e}"][data-col="${t}"]`);return o&&(o.classList.contains("blocked")||o.classList.contains("covered"))}placeDomino(e,t,o){this.dominoes.push({row:e,col:t,orientation:o}),this.renderBoard(),this.updateTileCounter(),this.checkWin()}getDominoSquares(e){const t=[[e.row,e.col]];return"horizontal"===e.orientation?t.push([e.row,e.col+1]):t.push([e.row+1,e.col]),t}removeDomino(e){this.dominoes.splice(e,1),this.renderBoard(),this.updateTileCounter()}toggleOrientation(){this.orientation="horizontal"===this.orientation?"vertical":"horizontal";document.getElementById("orientationBtn").textContent="Rotar: "+("horizontal"===this.orientation?"\u2b0c":"\u2b0d")}updateTileCounter(){const e=this.boards[this.currentBoard].maxDominoes;document.getElementById("tileCounter").textContent=`Fichas: ${this.dominoes.length}/${e}`}checkWin(){const e=this.boards[this.currentBoard].maxDominoes;this.dominoes.length===e&&setTimeout((()=>{alert(`\ud83c\udf89 \xa1Felicidades! \ud83c\udf89\n\n\xa1Has completado el tablero ${this.currentBoard}!\n\nColocaste ${this.dominoes.length} fichas de domin\xf3.`)}),300)}switchBoard(e){this.currentBoard=e,this.dominoes=[],document.querySelectorAll(".board-btn").forEach((t=>{t.classList.remove("active"),parseInt(t.dataset.board)===e&&t.classList.add("active")})),this.renderBoard(),this.updateTileCounter()}reset(){this.dominoes=[],this.renderBoard(),this.updateTileCounter()}}document.addEventListener("DOMContentLoaded",(()=>{window.puzzle=new ChessboardPuzzle}));